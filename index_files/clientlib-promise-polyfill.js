(function(l,g){"object"===typeof exports&&"undefined"!==typeof module?g():"function"===typeof define&&define.amd?define(g):g()})(this,function(){function l(a){var b=this.constructor;return this.then(function(c){return b.resolve(a()).then(function(){return c})},function(c){return b.resolve(a()).then(function(){return b.reject(c)})})}function g(){}function r(a,b){return function(){a.apply(b,arguments)}}function d(a){if(!(this instanceof d))throw new TypeError("Promises must be constructed via new");
if("function"!==typeof a)throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];p(a,this)}function q(a,b){for(;3===a._state;)a=a._value;0===a._state?a._deferreds.push(b):(a._handled=!0,d._immediateFn(function(){var c=1===a._state?b.onFulfilled:b.onRejected;if(null===c)(1===a._state?m:e)(b.promise,a._value);else{try{var d=c(a._value)}catch(f){e(b.promise,f);return}m(b.promise,d)}}))}function m(a,b){try{if(b===a)throw new TypeError("A promise cannot be resolved with itself.");
if(b&&("object"===typeof b||"function"===typeof b)){var c=b.then;if(b instanceof d){a._state=3;a._value=b;n(a);return}if("function"===typeof c){p(r(c,b),a);return}}a._state=1;a._value=b;n(a)}catch(h){e(a,h)}}function e(a,b){a._state=2;a._value=b;n(a)}function n(a){2===a._state&&0===a._deferreds.length&&d._immediateFn(function(){a._handled||d._unhandledRejectionFn(a._value)});for(var b=0,c=a._deferreds.length;b<c;b++)q(a,a._deferreds[b]);a._deferreds=null}function t(a,b,c){this.onFulfilled="function"===
typeof a?a:null;this.onRejected="function"===typeof b?b:null;this.promise=c}function p(a,b){var c=!1;try{a(function(a){c||(c=!0,m(b,a))},function(a){c||(c=!0,e(b,a))})}catch(h){c||(c=!0,e(b,h))}}var u=setTimeout;d.prototype["catch"]=function(a){return this.then(null,a)};d.prototype.then=function(a,b){var c=new this.constructor(g);q(this,new t(a,b,c));return c};d.prototype["finally"]=l;d.all=function(a){return new d(function(b,c){function d(a,e){try{if(e&&("object"===typeof e||"function"===typeof e)){var h=
e.then;if("function"===typeof h){h.call(e,function(b){d(a,b)},c);return}}f[a]=e;0===--g&&b(f)}catch(v){c(v)}}if(!a||"undefined"===typeof a.length)return c(new TypeError("Promise.all accepts an array"));var f=Array.prototype.slice.call(a);if(0===f.length)return b([]);for(var g=f.length,e=0;e<f.length;e++)d(e,f[e])})};d.resolve=function(a){return a&&"object"===typeof a&&a.constructor===d?a:new d(function(b){b(a)})};d.reject=function(a){return new d(function(b,c){c(a)})};d.race=function(a){return new d(function(b,
c){if(!a||"undefined"===typeof a.length)return c(new TypeError("Promise.race accepts an array"));for(var e=0,f=a.length;e<f;e++)d.resolve(a[e]).then(b,c)})};d._immediateFn="function"===typeof setImmediate&&function(a){setImmediate(a)}||function(a){u(a,0)};d._unhandledRejectionFn=function(a){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",a)};var k=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==
typeof global)return global;throw Error("unable to locate global object");}();"Promise"in k?k.Promise.prototype["finally"]||(k.Promise.prototype["finally"]=l):k.Promise=d});